CREATE SCHEMA IF NOT EXISTS `ak18b` DEFAULT CHARACTER SET utf8 ;

CREATE TABLE IF NOT EXISTS `ak18b`.`company` (
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`name`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`entity` (
  `id` INT(11) NOT NULL,
  `company_name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`, `company_name`),
  INDEX `fk_entity_company1_idx` (`company_name` ASC) VISIBLE,
  CONSTRAINT `fk_entity_company1`
    FOREIGN KEY (`company_name`)
    REFERENCES `ak18b`.`company` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`entity_type` (
  `id` INT(11) NOT NULL,
  `name` VARCHAR(64) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`user` (
  `username` VARCHAR(10) NOT NULL,
  `password` VARCHAR(60) NOT NULL,
  `forename` VARCHAR(45) NOT NULL,
  `surname` VARCHAR(45) NOT NULL,
  `email` VARCHAR(45) NOT NULL,
  `phone` VARCHAR(45) NULL DEFAULT NULL,
  `company_name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`username`, `company_name`),
  INDEX `fk_user_company1_idx` (`company_name` ASC) VISIBLE,
  CONSTRAINT `fk_user_company1`
    FOREIGN KEY (`company_name`)
    REFERENCES `ak18b`.`company` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`entity_type_field` (
  `id` INT(11) NOT NULL,
  `name` VARCHAR(45) NULL DEFAULT NULL,
  `type` VARCHAR(45) NULL DEFAULT NULL,
  `required` BIT(1) NULL DEFAULT NULL,
  `unique` BIT(1) NULL DEFAULT NULL,
  `department` VARCHAR(45) NULL DEFAULT NULL,
  `entity_type_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_entity_type_field_entity_type1_idx` (`entity_type_id` ASC) VISIBLE,
  CONSTRAINT `fk_entity_type_field_entity_type1`
    FOREIGN KEY (`entity_type_id`)
    REFERENCES `ak18b`.`entity_type` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`group` (
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`name`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`group_has_user` (
  `group_name` VARCHAR(45) NOT NULL,
  `user_username` VARCHAR(10) NOT NULL,
  PRIMARY KEY (`group_name`, `user_username`),
  INDEX `fk_group_has_user_user1_idx` (`user_username` ASC) VISIBLE,
  INDEX `fk_group_has_user_group_idx` (`group_name` ASC) VISIBLE,
  CONSTRAINT `fk_group_has_user_group`
    FOREIGN KEY (`group_name`)
    REFERENCES `ak18b`.`group` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_group_has_user_user1`
    FOREIGN KEY (`user_username`)
    REFERENCES `ak18b`.`user` (`username`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`can_modify` (
  `group_name` VARCHAR(45) NOT NULL,
  `entity_type_field_id` INT(11) NOT NULL,
  PRIMARY KEY (`group_name`, `entity_type_field_id`),
  INDEX `fk_group_has_entity_type_field_entity_type_field1_idx` (`entity_type_field_id` ASC) VISIBLE,
  INDEX `fk_group_has_entity_type_field_group1_idx` (`group_name` ASC) VISIBLE,
  CONSTRAINT `fk_group_has_entity_type_field_group1`
    FOREIGN KEY (`group_name`)
    REFERENCES `ak18b`.`group` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_group_has_entity_type_field_entity_type_field1`
    FOREIGN KEY (`entity_type_field_id`)
    REFERENCES `ak18b`.`entity_type_field` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`can_read` (
  `group_name` VARCHAR(45) NOT NULL,
  `entity_type_field_id` INT(11) NOT NULL,
  PRIMARY KEY (`group_name`, `entity_type_field_id`),
  INDEX `fk_group_has_entity_type_field1_entity_type_field1_idx` (`entity_type_field_id` ASC) VISIBLE,
  INDEX `fk_group_has_entity_type_field1_group1_idx` (`group_name` ASC) VISIBLE,
  CONSTRAINT `fk_group_has_entity_type_field1_group1`
    FOREIGN KEY (`group_name`)
    REFERENCES `ak18b`.`group` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_group_has_entity_type_field1_entity_type_field1`
    FOREIGN KEY (`entity_type_field_id`)
    REFERENCES `ak18b`.`entity_type_field` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`entity_type_has_entity` (
  `entity_type_id` INT(11) NOT NULL,
  `entity_id` INT(11) NOT NULL,
  `entity_company_name` VARCHAR(64) NOT NULL,
  INDEX `fk_entity_type_has_entity_entity1_idx` (`entity_id` ASC, `entity_company_name` ASC) VISIBLE,
  INDEX `fk_entity_type_has_entity_entity_type1_idx` (`entity_type_id` ASC) VISIBLE,
  CONSTRAINT `fk_entity_type_has_entity_entity_type1`
    FOREIGN KEY (`entity_type_id`)
    REFERENCES `ak18b`.`entity_type` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_entity_type_has_entity_entity1`
    FOREIGN KEY (`entity_id` , `entity_company_name`)
    REFERENCES `ak18b`.`entity` (`id` , `company_name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`can_create` (
  `group_name` VARCHAR(45) NOT NULL,
  `entity_type_field_id` INT(11) NOT NULL,
  PRIMARY KEY (`group_name`, `entity_type_field_id`),
  INDEX `fk_group_has_entity_type_field_entity_type_field2_idx` (`entity_type_field_id` ASC) VISIBLE,
  INDEX `fk_group_has_entity_type_field_group2_idx` (`group_name` ASC) VISIBLE,
  CONSTRAINT `fk_group_has_entity_type_field_group2`
    FOREIGN KEY (`group_name`)
    REFERENCES `ak18b`.`group` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_group_has_entity_type_field_entity_type_field2`
    FOREIGN KEY (`entity_type_field_id`)
    REFERENCES `ak18b`.`entity_type_field` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE TABLE IF NOT EXISTS `ak18b`.`can_delete` (
  `group_name` VARCHAR(45) NOT NULL,
  `entity_type_field_id` INT(11) NOT NULL,
  PRIMARY KEY (`group_name`, `entity_type_field_id`),
  INDEX `fk_group_has_entity_type_field_entity_type_field3_idx` (`entity_type_field_id` ASC) VISIBLE,
  INDEX `fk_group_has_entity_type_field_group3_idx` (`group_name` ASC) VISIBLE,
  CONSTRAINT `fk_group_has_entity_type_field_group3`
    FOREIGN KEY (`group_name`)
    REFERENCES `ak18b`.`group` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_group_has_entity_type_field_entity_type_field3`
    FOREIGN KEY (`entity_type_field_id`)
    REFERENCES `ak18b`.`entity_type_field` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;
